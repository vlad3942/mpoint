<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.6.xsd"
    objectQuotingStrategy="QUOTE_ONLY_RESERVED_WORDS">

    <changeSet author="Anna Lagad" id="2020-11-15-setup-v2.25.7-system">

        <createTable  catalogName="system"
                      schemaName="system"
                      tableName="routefeature_tbl"
                      remarks="Hold list of all available route feature">

            <column name="id"
                    type="bigserial"
                    autoIncrement="true">

                <constraints nullable="false" primaryKey="true"/>
            </column>

            <column name="featurename"
                    type="varchar(150)"
                    remarks="Hold route feature name supported by CellPoint Digital">

                <constraints nullable="false"/>
            </column>

            <column name="created"
                    type="timestamp with time zone"
                    remarks="Timestamp identifying when the route feature was originally created"
                    defaultValueComputed="now()">

                <constraints nullable="false"/>
            </column>

            <column name="modified"
                    type="timestamp with time zone"
                    remarks="Timestamp identifying when the route feature was last modified"
                    defaultValueComputed="now()">

                <constraints nullable="false"/>
            </column>

            <column name="enabled"
                    type="boolean"
                    remarks="Flag indicating whether the route feature is considered active"
                    defaultValueBoolean="true">

                <constraints nullable="false"/>
            </column>

        </createTable>

        <createIndex catalogName="system"
                     schemaName="system"
                     tableName="routefeature_tbl"
                     indexName="routefeature_tbl_id_idx">

            <column name="id"/>
        </createIndex>

        <createTable  catalogName="client"
                      schemaName="client"
                      tableName="routefeature_tbl"
                      remarks="Hold route feature configured for the client">

            <column name="id"
                    type="bigserial"
                    autoIncrement="true">

                <constraints nullable="false" primaryKey="true"/>
            </column>

            <column name="clientid"
                    type="int"
                    remarks="Hold unique client id">

                <constraints nullable="false"/>
            </column>

            <column name="routeconfigid"
                    type="int"
                    remarks="Hold unique id of route configuration">

                <constraints nullable="false"/>
            </column>

            <column name="featureid"
                    type="int"
                    remarks="Hold unique id of route feature">

                <constraints nullable="false"/>
            </column>

            <column name="enabled"
                    type="boolean"
                    remarks="Flag indicating whether the route feature is considered active"
                    defaultValueBoolean="true">

                <constraints nullable="false"/>
            </column>

            <column name="created"
                    type="timestamp with time zone"
                    remarks="Timestamp identifying when the route feature was originally created"
                    defaultValueComputed="now()">

                <constraints nullable="false"/>
            </column>

            <column name="modified"
                    type="timestamp with time zone"
                    remarks="Timestamp identifying when the route feature was last modified"
                    defaultValueComputed="now()">

                <constraints nullable="false"/>
            </column>

        </createTable>

        <createIndex catalogName="client"
                     schemaName="client"
                     tableName="routefeature_tbl"
                     indexName="routefeature_tbl_clientid_idx">

            <column name="clientid"/>
        </createIndex>

        <createIndex catalogName="client"
                     schemaName="client"
                     tableName="routefeature_tbl"
                     indexName="routefeature_tbl_featureid_idx">

            <column name="featureid"/>
        </createIndex>

        <createIndex catalogName="client"
                     schemaName="client"
                     tableName="routefeature_tbl"
                     indexName="routefeature_tbl_routeconfigid_idx">

            <column name="routeconfigid"/>
        </createIndex>

        <createTable  catalogName="client"
                      schemaName="client"
                      tableName="routeconfig_tbl"
                      remarks="Hold route specific configuration">

            <column name="id"
                    type="bigserial"
                    autoIncrement="true">

                <constraints nullable="false" primaryKey="true"/>
            </column>

            <column name="routeid"
                    type="int"
                    remarks="Hold unique route id">

                <constraints nullable="false"/>
            </column>

            <column name="name"
                    type="text"
                    remarks="Hold user defined name for the route">

                <constraints nullable="false"/>
            </column>

            <column name="capturetype"
                    type="int4"
                    remarks="Hold capture type of the route">

            </column>

            <column name="mid"
                    type="text"
                    remarks="Hold route specific merchant id">

                <constraints nullable="false"/>
            </column>

            <column name="countryid"
                    type="int"
                    remarks="Hold unique id of country">

                <constraints nullable="true"/>
            </column>

            <column name="currencyid"
                    type="int"
                    remarks="Hold unique id of the currency">

                <constraints nullable="true"/>
            </column>

            <column name="username"
                    type="text"
                    remarks="Hold username">

                <constraints nullable="false"/>
            </column>

            <column name="password"
                    type="text"
                    remarks="Hold password">

                <constraints nullable="false"/>
            </column>

            <column name="enabled"
                    type="boolean"
                    remarks="Flag indicating whether the route configuration is considered active"
                    defaultValueBoolean="true">

                <constraints nullable="false"/>
            </column>

            <column name="created"
                    type="timestamp with time zone"
                    remarks="Timestamp identifying when the route configuration was originally created"
                    defaultValueComputed="now()">

                <constraints nullable="false"/>
            </column>

            <column name="modified"
                    type="timestamp with time zone"
                    remarks="Timestamp identifying when the route configuration was last modified"
                    defaultValueComputed="now()">

                <constraints nullable="false"/>
            </column>

        </createTable>

        <createIndex catalogName="client"
                     schemaName="client"
                     tableName="routeconfig_tbl"
                     indexName="routeconfig_tbl_countryid_idx">

            <column name="countryid"/>
        </createIndex>

        <createIndex catalogName="client"
                     schemaName="client"
                     tableName="routeconfig_tbl"
                     indexName="routeconfig_tbl_currencyid_idx">

            <column name="currencyid"/>
        </createIndex>

        <createIndex catalogName="client"
                     schemaName="client"
                     tableName="routeconfig_tbl"
                     indexName="routeconfig_tbl_routeid_idx">

            <column name="routeid"/>
        </createIndex>

        <createTable  catalogName="client"
                      schemaName="client"
                      tableName="route_tbl"
                      remarks="Hold client route">

            <column name="id"
                    type="bigserial"
                    autoIncrement="true">

                <constraints nullable="false" primaryKey="true"/>
            </column>

            <column name="clientid"
                    type="int"
                    remarks="Hold unique client id">

                <constraints nullable="false"/>
            </column>

            <column name="providerid"
                    type="int"
                    remarks="Hold unique provider id">

                <constraints nullable="false"/>
            </column>

            <column name="created"
                    type="timestamp with time zone"
                    remarks="Timestamp identifying when the client route was originally created"
                    defaultValueComputed="now()">

                <constraints nullable="false"/>
            </column>

            <column name="modified"
                    type="timestamp with time zone"
                    remarks="Timestamp identifying when the client route was last modified"
                    defaultValueComputed="now()">

                <constraints nullable="false"/>
            </column>

            <column name="enabled"
                    type="boolean"
                    remarks="Flag indicating whether the client route is considered active"
                    defaultValueBoolean="true">

                <constraints nullable="false"/>
            </column>

        </createTable>

        <createIndex catalogName="client"
                     schemaName="client"
                     tableName="route_tbl"
                     indexName="route_tbl_clientid_idx">

            <column name="clientid"/>
        </createIndex>

        <createIndex catalogName="client"
                     schemaName="client"
                     tableName="route_tbl"
                     indexName="route_tbl_providerid_idx">

            <column name="providerid"/>
        </createIndex>

    </changeSet>


    <changeSet author="Anna Lagad"
               id="2020-11-23-setup-v2.25.7-system">

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="1"/>
            <column name="featurename" value="Pre-Auth"/>
        </insert>

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="2"/>
            <column name="featurename" value="Delayed Capture"/>
        </insert>

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="3"/>
            <column name="featurename" value="Batch Capture"/>
        </insert>

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="4"/>
            <column name="featurename" value="Partial Capture"/>
        </insert>

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="5"/>
            <column name="featurename" value="Refund"/>
        </insert>

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="6"/>
            <column name="featurename" value="Partial Refund"/>
        </insert>

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="7"/>
            <column name="featurename" value="Settlement"/>
        </insert>

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="8"/>
            <column name="featurename" value="Recurring"/>
        </insert>

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="9"/>
            <column name="featurename" value="3DS"/>
        </insert>

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="10"/>
            <column name="featurename" value="Installment"/>
        </insert>

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="11"/>
            <column name="featurename" value="Store Card"/>
        </insert>

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="12"/>
            <column name="featurename" value="Channel Mobile"/>
        </insert>

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="13"/>
            <column name="featurename" value="Channel Web"/>
        </insert>

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="14"/>
            <column name="featurename" value="Channel Others"/>
        </insert>

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="15"/>
            <column name="featurename" value="Pre-auth Fraud"/>
        </insert>

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="16"/>
            <column name="featurename" value="Post-Auth Fraud"/>
        </insert>

        <insert catalogName="system"
                schemaName="system"
                tableName="routefeature_tbl">

            <column name="id" value="17"/>
            <column name="featurename" value="Voids"/>
        </insert>

    </changeSet>

</databaseChangeLog>
