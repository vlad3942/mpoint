<?php
/**
 *
 * @author Jonatan Evald Buus
 * @copyright Cellpoint Mobile
 * @link http://www.cellpointmobile.com
 * @package mConsole
 * @version 1.10
 */

// Require Global Include File
require_once("../../inc/include.php");

// Require API for Simple DOM manipulation
require_once(sAPI_CLASS_PATH ."simpledom.php");

// Require Business logic for the validating client Input
require_once(sCLASS_PATH ."/validate.php");

// Add allowed min and max length for the password to the list of constants used for Text Tag Replacement
$_OBJ_TXT->loadConstants(array("AUTH MIN LENGTH" => Constants::iAUTH_MIN_LENGTH, "AUTH MAX LENGTH" => Constants::iAUTH_MAX_LENGTH) );

$_SERVER['PHP_AUTH_USER'] = "CPMDemo";
$_SERVER['PHP_AUTH_PW'] = "DEMOisNO_2";

$HTTP_RAW_POST_DATA = '<?xml version="1.0" encoding="UTF-8"?>';
$HTTP_RAW_POST_DATA .= '<root>';
$HTTP_RAW_POST_DATA .= '<search>';
$HTTP_RAW_POST_DATA .= '<userid></userid>';
$HTTP_RAW_POST_DATA .= '<transactionno></transactionno>';
$HTTP_RAW_POST_DATA .= '<orderno></orderno>';
$HTTP_RAW_POST_DATA .= '<mobile>30206162</mobile>';
$HTTP_RAW_POST_DATA .= '<email></email>';
$HTTP_RAW_POST_DATA .= '</search>';
$HTTP_RAW_POST_DATA .= '</root>';

$obj_DOM = simpledom_load_string($HTTP_RAW_POST_DATA);

if (array_key_exists("PHP_AUTH_USER", $_SERVER) === true && array_key_exists("PHP_AUTH_PW", $_SERVER) === true)
{
	if ( ($obj_DOM instanceof SimpleDOMElement) === true && $obj_DOM->validate("http://". str_replace("mpoint", "mconsole", $_SERVER['HTTP_HOST']) ."/protocols/mconsole.xsd") === true && count($obj_DOM->search) > 0)
	{
		$obj_mPoint = new General($_OBJ_DB, $_OBJ_TXT);
		
			$xml = '<status code="100">Login successful</status>
					<history account-id="49941" sorted-by="id" sort-order="descending"><transaction id="283954" mpoint-id="1767158" type-id="1000"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">20000</amount><price>200,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><timestamp>2013-07-09 13:21:27+00:00</timestamp></transaction><transaction id="283955" mpoint-id="1767158" order-no="" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">20000</amount><price>200,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="8">VISA</card><timestamp>2013-07-09 13:21:27+00:00</timestamp></transaction><transaction id="283957" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">2560</amount><price>25,60 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="49942"><name>Aslam Khan</name><mobile country-id="610">3335204489</mobile><email>aaa@test.test</email></to><timestamp>2013-07-09 13:29:59+00:00</timestamp><message>test 1</message></transaction><transaction id="283959" state-id="1809" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">2500</amount><price>25,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="49943"><name /><mobile country-id="610">3335204489</mobile><email>aaa@test.test</email></to><timestamp>2013-07-09 13:31:05+00:00</timestamp><message>test 13</message></transaction><transaction id="283961" mpoint-id="1767163" order-no="" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">100</amount><price>1,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="2">Dankort</card><timestamp>2013-07-09 13:35:44+00:00</timestamp></transaction><transaction id="283966" mpoint-id="1767175" type-id="1000"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">30000</amount><price>300,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><timestamp>2013-07-09 14:36:22+00:00</timestamp></transaction><transaction id="283967" mpoint-id="1767175" order-no="" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">30000</amount><price>300,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="8">VISA</card><timestamp>2013-07-09 14:36:22+00:00</timestamp></transaction><transaction id="284122" state-id="1809" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">2500</amount><price>25,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="49975"><name /><mobile country-id="610">2100000000</mobile><email /></to><timestamp>2013-07-12 10:07:20+00:00</timestamp><message>Test</message></transaction><transaction id="284124" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">2500</amount><price>25,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="49050"><name /><mobile country-id="610">3439844284</mobile><email>sdd@dd.com</email></to><timestamp>2013-07-12 10:07:35+00:00</timestamp><message>Test</message></transaction><transaction id="284161" mpoint-id="1767606" type-id="1000"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">20000</amount><price>200,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><timestamp>2013-07-16 10:03:30+00:00</timestamp></transaction><transaction id="284162" mpoint-id="1767606" order-no="" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">20000</amount><price>200,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="8">VISA</card><timestamp>2013-07-16 10:03:30+00:00</timestamp></transaction><transaction id="284165" mpoint-id="1767614" order-no="324234" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">10000</amount><price>100,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="2">Dankort</card><timestamp>2013-07-16 12:04:27+00:00</timestamp></transaction><transaction id="284166" mpoint-id="1767615" order-no="324234" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">10000</amount><price>100,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="8">VISA</card><timestamp>2013-07-16 12:05:54+00:00</timestamp></transaction><transaction id="284167" mpoint-id="1767616" order-no="324234" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">10000</amount><price>100,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="2">Dankort</card><timestamp>2013-07-16 12:06:37+00:00</timestamp></transaction><transaction id="284168" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">2500</amount><price>25,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="49931"><name /><mobile country-id="610">3329486022</mobile><email>aslam@kjan.zz</email></to><timestamp>2013-07-16 12:18:04+00:00</timestamp><message /></transaction><transaction id="284171" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">2100</amount><price>21,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3439844285</address><from account-id="49731"><name>Sdfg </name><mobile country-id="610">3439844285</mobile><email /></from><to account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></to><timestamp>2013-07-16 12:19:25+00:00</timestamp><message /></transaction><transaction id="284187" mpoint-id="1767697" type-id="1000"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">100000</amount><price>1000,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><timestamp>2013-07-17 08:20:40+00:00</timestamp></transaction><transaction id="284188" mpoint-id="1767697" order-no="" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">100000</amount><price>1000,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="8">VISA</card><timestamp>2013-07-17 08:20:40+00:00</timestamp></transaction><transaction id="284189" mpoint-id="1767698" order-no="324234" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">10000</amount><price>100,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="2">Dankort</card><timestamp>2013-07-17 08:24:14+00:00</timestamp></transaction><transaction id="284190" mpoint-id="1767700" order-no="324234" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">10000</amount><price>100,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="7">Master Card</card><timestamp>2013-07-17 08:25:21+00:00</timestamp></transaction><transaction id="284191" mpoint-id="1767703" order-no="324234" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">10000</amount><price>100,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="6">Maestro</card><timestamp>2013-07-17 08:27:25+00:00</timestamp></transaction><transaction id="284192" mpoint-id="1767704" order-no="324234" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">10000</amount><price>100,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="7">Master Card</card><timestamp>2013-07-17 08:28:43+00:00</timestamp></transaction><transaction id="284193" mpoint-id="1767709" type-id="1000"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">100000</amount><price>1000,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><timestamp>2013-07-17 08:34:22+00:00</timestamp></transaction><transaction id="284194" mpoint-id="1767709" order-no="" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">100000</amount><price>1000,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="7">Master Card</card><timestamp>2013-07-17 08:34:22+00:00</timestamp></transaction><transaction id="284195" mpoint-id="1767710" type-id="1000"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">30000</amount><price>300,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><timestamp>2013-07-17 08:35:04+00:00</timestamp></transaction><transaction id="284196" mpoint-id="1767710" order-no="" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">30000</amount><price>300,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="7">Master Card</card><timestamp>2013-07-17 08:35:04+00:00</timestamp></transaction><transaction id="284197" mpoint-id="1767711" type-id="1000"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">80000</amount><price>800,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><timestamp>2013-07-17 08:35:44+00:00</timestamp></transaction><transaction id="284198" mpoint-id="1767711" order-no="" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">80000</amount><price>800,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="7">Master Card</card><timestamp>2013-07-17 08:35:44+00:00</timestamp></transaction><transaction id="284215" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">1000</amount><price>10,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="49931"><name /><mobile country-id="610">3329486022</mobile><email>aslam@kjan.zz</email></to><timestamp>2013-07-17 10:47:06+00:00</timestamp><message /></transaction><transaction id="284218" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">25400</amount><price>254,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="49050"><name /><mobile country-id="610">3439844284</mobile><email>sdd@dd.com</email></to><timestamp>2013-07-17 11:16:50+00:00</timestamp><message /></transaction><transaction id="284220" mpoint-id="1767741" type-id="1000"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">90000</amount><price>900,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><timestamp>2013-07-17 11:26:56+00:00</timestamp></transaction><transaction id="284221" mpoint-id="1767741" order-no="" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">90000</amount><price>900,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="6">Maestro</card><timestamp>2013-07-17 11:26:56+00:00</timestamp></transaction><transaction id="284222" mpoint-id="1767744" order-no="324234" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">10000</amount><price>100,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="2">Dankort</card><timestamp>2013-07-17 11:28:52+00:00</timestamp></transaction><transaction id="284226" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">3500</amount><price>35,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="49731"><name>Sdfg </name><mobile country-id="610">3439844285</mobile><email /></to><timestamp>2013-07-17 12:03:35+00:00</timestamp><message /></transaction><transaction id="284228" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">21400</amount><price>214,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="49731"><name>Sdfg </name><mobile country-id="610">3439844285</mobile><email /></to><timestamp>2013-07-17 12:12:06+00:00</timestamp><message /></transaction><transaction id="284230" mpoint-id="1767762" order-no="324234" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">10000</amount><price>100,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="8">VISA</card><timestamp>2013-07-17 12:12:53+00:00</timestamp></transaction><transaction id="284231" mpoint-id="1767763" type-id="1000"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">20000</amount><price>200,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><timestamp>2013-07-17 12:13:55+00:00</timestamp></transaction><transaction id="284232" mpoint-id="1767763" order-no="" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">20000</amount><price>200,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="8">VISA</card><timestamp>2013-07-17 12:13:55+00:00</timestamp></transaction><transaction id="284236" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">2400</amount><price>24,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="50034"><name>Aslam </name><mobile country-id="610">3329486022</mobile><email>tsd@ee.com</email></to><timestamp>2013-07-17 15:18:11+00:00</timestamp><message /></transaction><transaction id="284459" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">1200</amount><price>12,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="49071"><name>Aslam Lhan</name><mobile country-id="610">3439844284</mobile><email>sdd@dd.com</email></to><timestamp>2013-07-22 09:17:55+00:00</timestamp><message>Test1</message></transaction><transaction id="284461" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">2500</amount><price>25,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="49918"><name>Fggthgh </name><mobile country-id="610">3215678557</mobile><email>dgfthv@fghjo.com</email></to><timestamp>2013-07-22 09:18:40+00:00</timestamp><message>Test1</message></transaction><transaction id="284463" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">2400</amount><price>24,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="49071"><name>Aslam Lhan</name><mobile country-id="610">3439844284</mobile><email>sdd@dd.com</email></to><timestamp>2013-07-22 09:19:41+00:00</timestamp><message>Test1</message></transaction><transaction id="284469" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">2500</amount><price>25,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="49071"><name>Aslam Lhan</name><mobile country-id="610">3439844284</mobile><email>sdd@dd.com</email></to><timestamp>2013-07-22 09:27:10+00:00</timestamp><message>test 1</message></transaction><transaction id="284566" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">2100</amount><price>21,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="50066"><name>Aslam Khan</name><mobile country-id="610">3329486022</mobile><email>aslam.khan@teo-intl.cu</email></to><timestamp>2013-07-23 07:03:30+00:00</timestamp><message>Test data</message></transaction><transaction id="284568" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">1102</amount><price>11,02 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="50066"><name>Aslam Khan</name><mobile country-id="610">3329486022</mobile><email>aslam.khan@teo-intl.cu</email></to><timestamp>2013-07-23 07:04:33+00:00</timestamp><message>Teat</message></transaction><transaction id="284570" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">19030</amount><price>190,30 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="50066"><name>Aslam Khan</name><mobile country-id="610">3329486022</mobile><email>aslam.khan@teo-intl.cu</email></to><timestamp>2013-07-23 07:05:20+00:00</timestamp><message>Twst 19030</message></transaction><transaction id="284572" state-id="1809" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">2508</amount><price>25,08 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="50091"><name /><mobile country-id="610">3130000000</mobile><email /></to><timestamp>2013-07-23 07:05:51+00:00</timestamp><message>Test</message></transaction><transaction id="284574" state-id="1809" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">2410</amount><price>24,10 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="50092"><name /><mobile country-id="610">3005742494</mobile><email /></to><timestamp>2013-07-23 07:08:40+00:00</timestamp><message>Test</message></transaction><transaction id="284588" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">4100</amount><price>41,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="50066"><name>Aslam Khan</name><mobile country-id="610">3329486022</mobile><email>aslam.khan@teo-intl.cu</email></to><timestamp>2013-07-23 09:16:53+00:00</timestamp><message /></transaction><transaction id="284647" state-id="1809" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">1225</amount><price>12,25 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="50113"><name /><mobile country-id="610">2355457586</mobile><email /></to><timestamp>2013-07-24 06:32:07+00:00</timestamp><message>test</message></transaction><transaction id="284649" mpoint-id="1768112" type-id="1000"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">70000</amount><price>700,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><timestamp>2013-07-24 06:40:18+00:00</timestamp></transaction><transaction id="284650" mpoint-id="1768112" order-no="" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">70000</amount><price>700,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="8">VISA</card><timestamp>2013-07-24 06:40:18+00:00</timestamp></transaction><transaction id="284709" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">1200</amount><price>12,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="49060"><name /><mobile country-id="610">1234567890</mobile><email /></to><timestamp>2013-07-24 13:09:00+00:00</timestamp><message /></transaction><transaction id="284711" state-id="1809" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">2101</amount><price>21,01 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="50128"><name /><mobile country-id="610">1234569870</mobile><email /></to><timestamp>2013-07-24 13:09:53+00:00</timestamp><message /></transaction><transaction id="284713" state-id="1800" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">12000</amount><price>120,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="49060"><name /><mobile country-id="610">1234567890</mobile><email /></to><timestamp>2013-07-24 13:10:20+00:00</timestamp><message /></transaction><transaction id="284721" state-id="1809" type-id="1002"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">1100</amount><price>11,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><from account-id="49941"><name>Rashid Kæån</name><mobile country-id="610">3332231212</mobile><email>wy@ues.ffy</email></from><to account-id="50131"><name /><mobile country-id="610">1245455545</mobile><email /></to><timestamp>2013-07-24 13:15:30+00:00</timestamp><message /></transaction><transaction id="284724" mpoint-id="1768153" type-id="1000"><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">10000</amount><price>100,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><timestamp>2013-07-24 13:32:03+00:00</timestamp></transaction><transaction id="284725" mpoint-id="1768153" order-no="" type-id="1009"><client id="10007">Wallet.dk</client><amount country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">10000</amount><price>100,00 kr.</price><fee country-id="100" currency="DKK" format="{PRICE} {CURRENCY}" symbol="kr.">0</fee><ip>131.165.91.131</ip><address>3332231212</address><card id="8">VISA</card><timestamp>2013-07-24 13:32:03+00:00</timestamp></transaction></history>';
	$xml =  utf8_encode ( $xml );
	
	}
	// Error: Invalid XML Document
	elseif ( ($obj_DOM instanceof SimpleDOMElement) === false)
	{
		header("HTTP/1.1 415 Unsupported Media Type");
		
		$xml = '<status code="415">Invalid XML Document</status>';
	}
	// Error: Wrong operation
	elseif (count($obj_DOM->login) == 0)
	{
		header("HTTP/1.1 400 Bad Request");
	
		$xml = '';
		foreach ($obj_DOM->children() as $obj_Elem)
		{
			$xml .= '<status code="400">Wrong operation: '. $obj_Elem->getName() .'</status>'; 
		}
	}
	// Error: Invalid Input
	else
	{
		header("HTTP/1.1 400 Bad Request");
		$aObj_Errs = libxml_get_errors();
		
		$xml = '';
		for ($i=0; $i<count($aObj_Errs); $i++)
		{
			$xml .= '<status code="400">'. htmlspecialchars($aObj_Errs[$i]->message, ENT_NOQUOTES) .'</status>';
		}
	}
}
else
{
	header("HTTP/1.1 401 Unauthorized");
	
	$xml = '<status code="401">Authorization required</status>';
}
header("Content-Type: text/xml; charset=\"UTF-8\"");

echo $xml;
?>